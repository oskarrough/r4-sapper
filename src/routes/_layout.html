<svelte:window on:keydown="onKeydown(event)" />

<div class="viewport">
	<header>
		<a href="/"><img src="icon-r4000.svg" alt="Radio4000" /></a>
		<Autocomplete />
	</header>

	<main>
		{#if $slug}
			<!-- <radio4000-player channel-slug={$slug}></radio4000-player> -->
			<iframe src={'https://api.radio4000.com/embed?slug=' + $slug} width="320" height="500" title="Radio4000" />
		{/if}

		<svelte:component this={child.component} {...child.props}/>
	</main>
</div>

<style>
	.viewport {
		display: flex;
		flex-flow: column;
		min-height: 100vh;
	}
	header {
		/*background: #5d1ae6;
		background: hsl(72, 100%, 98%);
			*/
		background: #222;
		display: flex;
		flex-flow: row nowrap;
	}
	header img {
		height: 1.8rem;
		margin: 0.7rem 0.6rem 0.5rem;
	}
	main {
		display: flex;
		flex-flow: column;
		flex: 1;
	}
	iframe {
		flex: 1;
		width: 100%;
		height: auto;
		border: 0;
	}
</style>

<script>
	export default {
		components: {
			Autocomplete: '../components/Autocomplete.html'
		},
		methods: {
			onKeydown(event) {
				const {keyCode} = event
				console.log(keyCode)
				if (keyCode === 191) this.focusInput()
				if (keyCode === 27) this.focusInput(false)
			},
			focusInput(shouldFocus = true) {
				event.preventDefault()
				const input = this.options.target.querySelector('.aa-input')
				shouldFocus ? input.focus() : input.blur()
			}
		}
	}
</script>
